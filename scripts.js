var map = L.map('map').setView([39.984, -0.044], 13);

var CartoDB_PositronNoLabels = L.tileLayer('https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_nolabels/{z}/{x}/{y}.png', {
  attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>',
  subdomains: 'abcd',
  maxZoom: 19
}).addTo(map);



// ---> Espaitec 2 marker
var marker = L.marker([39.993787, -0.073916]).addTo(map);
marker.bindPopup("<b>UJI</b><br>This is Espaitec 2.");



// ---> "You clicked here" alert
function onMapClick(e) {
  console.log("You clicked the map at " + e.latlng);
  console.log(e);
};

map.on('click', onMapClick);



// ---> Geolocation marker
map.locate({setView: true, maxZoom: 16});

function onLocationFound(e) {
  var radius = e.accuracy / 2;
  L.marker(e.latlng).addTo(map)
    .bindPopup("You are within " + radius + " meters from this point").openPopup();
  L.circle(e.latlng, radius).addTo(map);
}
map.on('locationfound', onLocationFound);

function onLocationError(e) {
  console.log(e.message);
}
map.on('locationerror', onLocationError);



// ---> Data
var addressPoints = [
  [55.6667,12.5833,1,'80'],[56,10,1,'83'],[40.4086,-3.6922,1,'94'],[19.4342,-99.1386,1,'94'],
  [39.9881,-0.0435,1,'65'],[46.0965,-64.7976,1,'98'],[40,-4,1,'38'],[19.4285,-99.1277,1,'60'],
  [40.4776,-3.7392,1,'102'],[-27.5047,152.979,1,'80'],[-30.9546,-58.7833,1,'68'],
  [39.9875,-0.0392,1,'45'],[39.9875,-0.0392,1,'58'],[40,-4,1,'89'],[39.9875,-0.0392,1,'55'],
  [37.387,-5.9501,1,'94'],[41.9902,-7.8674,1,'97'],[39.9875,-0.0392,1,'90'],
  [38.8833,-6.9667,1,'107'],[39.9875,-0.0392,1,'61'],[41.85,-87.65,1,'55'],
  [-30.9546,-58.7833,1,'85'],[39.9881,-0.0435,1,'23'],[39.9875,-0.0392,1,'58'],
  [-30.9546,-58.7833,1,'75'],[39.9881,-0.0435,1,'45'],[39.4667,-0.3667,1,'63'],
  [39.4667,-0.3667,1,'47'],[39.4667,-0.3667,1,'108'],[39.9881,-0.0435,1,'72'],
  [39.9875,-0.0392,1,'92'],[39.9875,-0.0392,1,'95'],[39.4667,-0.3667,1,'86'],
  [39.9881,-0.0435,1,'48'],[41.85,-87.65,1,'70'],[39.9875,-0.0392,1,'59'],
  [-30.9546,-58.7833,1,'56'],[-30.9546,-58.7833,1,'68'],[39.9875,-0.0392,1,'47'],
  [39.9875,-0.0392,1,'44'],[39.9875,-0.0392,1,'55'],[9.9189,-84.1399,1,'68'],
  [39.9875,-0.0392,1,'48'],[39.9875,-0.0392,1,'36'],[39.9875,-0.0392,1,'76'],
  [39.9875,-0.0392,1,'78'],[39.9875,-0.0392,1,'74'],[39.9875,-0.0392,1,'60'],
  [39.9881,-0.0435,1,'60'],[39.9881,-0.0435,1,'66'],[39.9881,-0.0435,1,'78'],
  [40,-4,1,'47'],[-30.9546,-58.7833,1,'58'],[43.3333,-2.8667,1,'80'],[19.4285,-99.1277,1,'31'],
  [38.3452,-0.4815,1,'97'],[41.6498,-0.9199,1,'77'],[37.999,-97.0133,1,'77'],
  [37.999,-97.0133,1,'100'],[9.9283,-84.0507,1,'75'],[39.9881,-0.0435,1,'100'],
  [19.4285,-99.1277,1,'67'],[51.05,-0.3333,1,'50'],[39.9875,-0.0392,1,'58'],
  [38.9674,-0.1816,1,'36'],[-30.9546,-58.7833,1,'76'],[-30.9546,-58.7833,1,'86'],
  [39.9875,-0.0392,1,'64'],[39.9875,-0.0392,1,'54'],[39.9875,-0.0392,1,'79'],
  [39.6833,-0.2667,1,'60'],[6.2681,100.422,1,'36'],[6.2681,100.422,1,'66'],
  [-33.8615,151.206,1,'70'],[-33.8615,151.206,1,'69'],[19.4342,-99.1386,1,'57'],
  [43.2609,-2.9388,1,'102'],[43.2609,-2.9388,1,'112'],[39.9875,-0.0392,1,'60'],
  [38.715,0.0498,1,'69'],[38.715,0.0498,1,'36'],[43.2609,-2.9388,1,'110'],[43.2609,-2.9388,1,'115'],
  [43.2609,-2.9388,1,'113'],[43.2609,-2.9388,1,'113'],[19.4285,-99.1277,1,'78'],
  [-30.9546,-58.7833,1,'66'],[40,-4,1,'64'],[40,-4,1,'63'],[39.9875,-0.0392,1,'55']
];

// ---> Marker Clusters
var markers = new L.MarkerClusterGroup();
var markerList = [];

for (var i = 0; i < addressPoints.length; i++) {
  var addressPoint = addressPoints[i];
  var marker = L.marker(L.latLng(addressPoint[0], addressPoint[1]));
  markerList.push(marker);
}

markers.addLayers(markerList);
map.addLayer(markers);



